<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.4.0 -->
<title>GSoC Week 5: Lots of messages | Keanu Nichols Blog</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="GSoC Week 5: Lots of messages" />
<meta name="author" content="Keanu Nichols" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Welcome to my second post, it’s going to be filled with lots of code as per usual and actual linking to repositories this time. This week I thought was going to be simple but boy was I wrong, ranging from commbining all the mailing lists to just creating a new table, and let’s not even get started on adding the date column to the SQL table. I also had to go forward with formating the SQL table to a specific data types." />
<meta property="og:description" content="Welcome to my second post, it’s going to be filled with lots of code as per usual and actual linking to repositories this time. This week I thought was going to be simple but boy was I wrong, ranging from commbining all the mailing lists to just creating a new table, and let’s not even get started on adding the date column to the SQL table. I also had to go forward with formating the SQL table to a specific data types." />
<link rel="canonical" href="http://localhost:4000/misc/2018/06/15/gsoc-Week-5.html" />
<meta property="og:url" content="http://localhost:4000/misc/2018/06/15/gsoc-Week-5.html" />
<meta property="og:site_name" content="Keanu Nichols Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-06-15T06:20:00-04:00" />
<script type="application/ld+json">
{"description":"Welcome to my second post, it’s going to be filled with lots of code as per usual and actual linking to repositories this time. This week I thought was going to be simple but boy was I wrong, ranging from commbining all the mailing lists to just creating a new table, and let’s not even get started on adding the date column to the SQL table. I also had to go forward with formating the SQL table to a specific data types.","author":{"@type":"Person","name":"Keanu Nichols"},"@type":"BlogPosting","url":"http://localhost:4000/misc/2018/06/15/gsoc-Week-5.html","headline":"GSoC Week 5: Lots of messages","dateModified":"2018-06-15T06:20:00-04:00","datePublished":"2018-06-15T06:20:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/misc/2018/06/15/gsoc-Week-5.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Keanu Nichols Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Keanu Nichols Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/portfolio/">Porfolio</a><a class="page-link" href="/temp/">temp</a></div>
      </nav></div>
</header>
<!-- Begin Jekyll SEO tag v2.4.0 -->
<title>GSoC Week 5: Lots of messages | Keanu Nichols Blog</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="GSoC Week 5: Lots of messages" />
<meta name="author" content="Keanu Nichols" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Welcome to my second post, it’s going to be filled with lots of code as per usual and actual linking to repositories this time. This week I thought was going to be simple but boy was I wrong, ranging from commbining all the mailing lists to just creating a new table, and let’s not even get started on adding the date column to the SQL table. I also had to go forward with formating the SQL table to a specific data types." />
<meta property="og:description" content="Welcome to my second post, it’s going to be filled with lots of code as per usual and actual linking to repositories this time. This week I thought was going to be simple but boy was I wrong, ranging from commbining all the mailing lists to just creating a new table, and let’s not even get started on adding the date column to the SQL table. I also had to go forward with formating the SQL table to a specific data types." />
<link rel="canonical" href="http://localhost:4000/misc/2018/06/15/gsoc-Week-5.html" />
<meta property="og:url" content="http://localhost:4000/misc/2018/06/15/gsoc-Week-5.html" />
<meta property="og:site_name" content="Keanu Nichols Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-06-15T06:20:00-04:00" />
<script type="application/ld+json">
{"description":"Welcome to my second post, it’s going to be filled with lots of code as per usual and actual linking to repositories this time. This week I thought was going to be simple but boy was I wrong, ranging from commbining all the mailing lists to just creating a new table, and let’s not even get started on adding the date column to the SQL table. I also had to go forward with formating the SQL table to a specific data types.","author":{"@type":"Person","name":"Keanu Nichols"},"@type":"BlogPosting","url":"http://localhost:4000/misc/2018/06/15/gsoc-Week-5.html","headline":"GSoC Week 5: Lots of messages","dateModified":"2018-06-15T06:20:00-04:00","datePublished":"2018-06-15T06:20:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/misc/2018/06/15/gsoc-Week-5.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">GSoC Week 5: Lots of messages</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-06-15T06:20:00-04:00" itemprop="datePublished">Jun 15, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img src="https://raw.githubusercontent.com/kmn5409/keanu-nichols/master/images/office.gif" alt="The Office" />
<br /><br />
Welcome to my second post, it’s going to be filled with lots of code as per usual and actual linking to repositories this time. This week I thought was going to be simple but boy was I wrong, ranging from commbining all the mailing lists to just creating a new table, and let’s not even get started on adding the date column to the SQL table. I also had to go forward with formating the SQL table to a specific data types.</p>

<p>So this week’s task with my mentor <a href="http://www.seangoggins.net/">Sean Goggins</a> is as follows:</p>

<h1 id="goals-for-the-week">Goals for the week:</h1>
<ol>
  <li>Build the single, unified table for PiperMail Storage: Done, this is called “mail_lists”</li>
  <li>
    <p>Have your python program that imports from Perceval downloads to the database add backend_name (PiperMail), Project (which should be a parameter on a method that runs Perceval against a set of mailing lists.) This might include something like a “mailing list job table.” Right now, you have a table called “Mailing_Lists” with two columns.  One is the backend, and the other is the link.</p>
  </li>
  <li>Explore the pros and cons of different persistence strategies using two main use cases: 
    <ul>
      <li>Researchers trying to understand linguistic trends within and across lists </li>
      <li>Community managers and researchers identifying a set of email communications containing different linguistic properties.  For example, sentiment analysis or some other linguistic marker. </li>
    </ul>
  </li>
  <li>(Stretch Goal) : Experiment with ways of filtering out old message strings from mailing lists and identifying mailing list discussion threads (some lists have them automatically, some don’t)  </li>
</ol>

<h1 id="ongoing-tasks">Ongoing Tasks:</h1>
<p> 1. The development / merge process </p>
<ol>
  <li>Getting to the know the metrics
 3. Configuring Augur for different data backends (i.e. mailing lists)</li>
</ol>

<h2 id="goals">Goals</h2>

<p>Goal 1:<br />
So for this goal we had to update the code from last, the problem with the code from last week was that it was seperating each of the mailing lists into seperate tables. After speaking with Sean we decided it would be best to have all the mailing list messages combines into one table to make it easier for someone to query something from the table. Now for me this was easier said than done, because for some of the messages they have a very long thread, now before I was ignoring the thread and only taking about 10000 characters in the message. If we look at line 2 we see that it’s just copying the contents of di[‘data’][‘body’][‘plain’] into temp which is the text in the message. Now in line 7 I just copy the first 10000 characters because when I tried to upload it to the SQL database I would get the error that data is being truncated because for example in one of the mailing threads there was around 240000 characters we can see it <a href="https://lists.opendaylight.org/pipermail/alto-dev/2017-January/000428.html">here</a>.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="k">def</span> <span class="nf">add_row_mess</span><span class="p">(</span><span class="n">columns1</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="n">di</span><span class="p">,</span><span class="n">archives</span><span class="p">):</span>
	<span class="n">temp</span> <span class="o">=</span> 	<span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'body'</span><span class="p">][</span><span class="s">'plain'</span><span class="p">]</span>
	<span class="n">words</span> <span class="o">=</span> <span class="s">""</span>
	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)):</span>
		<span class="n">words</span><span class="o">+=</span><span class="n">temp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
		<span class="k">if</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="ow">and</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)):</span>
			<span class="k">if</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">"&gt;"</span> <span class="ow">or</span> <span class="n">j</span><span class="o">&gt;</span><span class="mi">10000</span><span class="p">):</span>
				<span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'body'</span><span class="p">][</span><span class="s">'plain'</span><span class="p">]</span> <span class="o">=</span> <span class="n">words</span>
				<span class="k">break</span>
	<span class="n">li</span> <span class="o">=</span> <span class="p">[[</span><span class="n">di</span><span class="p">[</span><span class="s">'backend_name'</span><span class="p">],</span><span class="n">di</span><span class="p">[</span><span class="s">'origin'</span><span class="p">],</span><span class="n">archives</span><span class="p">,</span>
		   <span class="n">di</span><span class="p">[</span><span class="s">'category'</span><span class="p">],</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Subject'</span><span class="p">],</span>
		   <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Date'</span><span class="p">],</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'From'</span><span class="p">],</span>
		   <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Message-ID'</span><span class="p">],</span>
		   <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'body'</span><span class="p">][</span><span class="s">'plain'</span><span class="p">]</span> <span class="p">]]</span>
	<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">li</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">columns1</span><span class="p">)</span>
	<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">df3</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>I thought about it in terms of a linked list and inserting at tail but I was just inserting it at the tail and moving tmp to that new tail, I was instead still at prev and just kept adding tail to tmp. Picture is from <a href="https://www.geeksforgeeks.org/linked-list-set-2-inserting-a-node/">here</a></p>

<p><img src="https://raw.githubusercontent.com/kmn5409/keanu-nichols/master/images/Linkedlist_insert_last.png" alt="Linked-Lists" class="img-responsive" /></p>

<p>So before I even get started on my problem with the Date column in the SQL table I will just show you the outline for the Database, the code used throughout can be found <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/PiperReader%207.py">here</a></p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="n">df5</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">db_name</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="p">,</span><span class="n">if_exists</span><span class="o">=</span><span class="s">'replace'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
				<span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s">'backend_name'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
					<span class="s">'project'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
					<span class="s">'mailing_list'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
					<span class="s">'category'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
					<span class="s">'subject'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">400</span><span class="p">),</span>
					<span class="s">'date'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">DateTime</span><span class="p">(),</span>
					<span class="s">'timezone'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
					<span class="s">'message_from'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
					<span class="s">'message_id'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
					<span class="s">'message_text'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Text</span>				   
				<span class="p">})</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>That’s the code for it and it comes out for the column names in the table as seen below</p>

<figure class="highlight">
  <pre><code class="language-sql" data-lang="sql"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="o">|</span> <span class="n">backend_name</span> <span class="o">|</span> <span class="n">project</span> <span class="o">|</span> <span class="n">mailing_list</span> <span class="o">|</span> <span class="n">category</span> <span class="o">|</span> <span class="n">subject</span> <span class="o">|</span> <span class="n">date</span> <span class="o">|</span> <span class="n">timezone_UTC</span> <span class="o">|</span> <span class="n">message_from</span>    <span class="o">|</span> <span class="n">message_id</span> <span class="o">|</span> <span class="k">message_text</span>  <span class="o">|</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>Now we’re going to refer back to this piece of code I showed you before and specifically lines 16-19.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="code"><pre><span class="kn">from</span> <span class="nn">dateutil.parser</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="k">def</span> <span class="nf">add_row_mess</span><span class="p">(</span><span class="n">columns1</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="n">di</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">archives</span><span class="p">):</span>
	<span class="n">temp</span> <span class="o">=</span> 	<span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'body'</span><span class="p">][</span><span class="s">'plain'</span><span class="p">]</span>
	<span class="n">words</span> <span class="o">=</span> <span class="s">""</span>
	<span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
	<span class="n">val</span> <span class="o">=</span> <span class="bp">False</span>
	<span class="c">#print(temp,"\n\n\nHEREEEEEEEEEEEEE!!!!!!!!!!!\n\n\n")</span>
	<span class="n">prev</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">):</span>
		<span class="n">j</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span><span class="mi">5000</span><span class="p">):</span>
			<span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
			<span class="c">#date[5] = date[5][0:1] + ':' +  date[5][1:3]</span>
			<span class="c">#print(date[5])</span>
			<span class="n">split</span> <span class="o">=</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Date'</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">s</span> <span class="o">=</span> <span class="s">" "</span>
			<span class="n">date</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">split</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
			<span class="n">zone</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
			<span class="n">li</span> <span class="o">=</span> <span class="p">[[</span><span class="n">di</span><span class="p">[</span><span class="s">'backend_name'</span><span class="p">],</span><span class="n">di</span><span class="p">[</span><span class="s">'origin'</span><span class="p">],</span><span class="n">archives</span><span class="p">,</span>
			<span class="n">di</span><span class="p">[</span><span class="s">'category'</span><span class="p">],</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Subject'</span><span class="p">],</span>
			<span class="n">date</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span><span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'From'</span><span class="p">],</span>
			<span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Message-ID'</span><span class="p">],</span>
			<span class="n">temp</span><span class="p">[</span><span class="n">prev</span><span class="p">:</span><span class="n">j</span><span class="p">]</span> <span class="p">]]</span>
			<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">li</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">columns1</span><span class="p">)</span>
			<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
			<span class="n">df</span> <span class="o">=</span> <span class="n">df3</span>
			<span class="n">prev</span> <span class="o">=</span> <span class="n">j</span>
			<span class="n">row</span><span class="o">+=</span><span class="mi">1</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>Now my problem when using a function called parse (line 1)
is that in the json file the format looks like</p>

<figure class="highlight">
  <pre><code class="language-javascript" data-lang="javascript"><span class="s2">"Date"</span><span class="p">:</span> <span class="s2">"Fri, 23 Oct 2015 14:07:16 +0000"</span><span class="p">,</span></code></pre>
</figure>

<p>So the solution that I came up with and well Sean was the one that guided me there was to just have multiple rows in the SQL Database to store the different parts of the message. Now a good chunk of my time was spent on this because well I’m using pandas and utilizing dataframes, so when I tried to copy the contents of the message up to a certain point, in this case I went up to 5000 characters (line 11) I would store it in a dataframe (line 24) and then append that dataframe to the original dataframe I passed to the function (line 1). Now I spent hours not realizing that that initial dataframe df needed to be passed back df3 so that the addition would be fully completed in the loop, what was happening is that I would just copy the last message in the long message.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="code"><pre><span class="k">def</span> <span class="nf">add_row_mess</span><span class="p">(</span><span class="n">columns1</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="n">di</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">archives</span><span class="p">):</span>
	<span class="n">temp</span> <span class="o">=</span> 	<span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'body'</span><span class="p">][</span><span class="s">'plain'</span><span class="p">]</span>
	<span class="n">words</span> <span class="o">=</span> <span class="s">""</span>
	<span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
	<span class="n">val</span> <span class="o">=</span> <span class="bp">False</span>
	<span class="c">#print(temp,"\n\n\nHEREEEEEEEEEEEEE!!!!!!!!!!!\n\n\n")</span>
	<span class="n">prev</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">):</span>
		<span class="n">j</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span><span class="mi">5000</span><span class="p">):</span>
			<span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
			<span class="c">#date[5] = date[5][0:1] + ':' +  date[5][1:3]</span>
			<span class="c">#print(date[5])</span>
			<span class="n">split</span> <span class="o">=</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Date'</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">s</span> <span class="o">=</span> <span class="s">" "</span>
			<span class="n">date</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">split</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
			<span class="n">zone</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
			<span class="n">li</span> <span class="o">=</span> <span class="p">[[</span><span class="n">di</span><span class="p">[</span><span class="s">'backend_name'</span><span class="p">],</span><span class="n">di</span><span class="p">[</span><span class="s">'origin'</span><span class="p">],</span><span class="n">archives</span><span class="p">,</span>
			<span class="n">di</span><span class="p">[</span><span class="s">'category'</span><span class="p">],</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Subject'</span><span class="p">],</span>
			<span class="n">date</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span><span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'From'</span><span class="p">],</span>
			<span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Message-ID'</span><span class="p">],</span>
			<span class="n">temp</span><span class="p">[</span><span class="n">prev</span><span class="p">:</span><span class="n">j</span><span class="p">]</span> <span class="p">]]</span>
			<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">li</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">columns1</span><span class="p">)</span>
			<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
			<span class="n">df</span> <span class="o">=</span> <span class="n">df3</span>
			<span class="n">prev</span> <span class="o">=</span> <span class="n">j</span>
			<span class="n">row</span><span class="o">+=</span><span class="mi">1</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>I thought about it in terms of a linked list and inserting at tail but I was just inserting it at the tail and moving tmp to that new tail, I was instead still at prev and just kept adding tail to tmp.</p>

<p><img src="/images/Linkedlist_insert_last.png" alt="Linked-Lists" class="img-responsive" /></p>

<p>So before I even get started on my problem with the Date column in the SQL table I will just show you the outline for the Database:</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="n">df5</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">db_name</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="p">,</span><span class="n">if_exists</span><span class="o">=</span><span class="s">'replace'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
				<span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s">'backend_name'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
					<span class="s">'project'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
					<span class="s">'mailing_list'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
					<span class="s">'category'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
					<span class="s">'subject'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">400</span><span class="p">),</span>
					<span class="s">'date'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">DateTime</span><span class="p">(),</span>
					<span class="s">'timezone'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
					<span class="s">'message_from'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
					<span class="s">'message_id'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
					<span class="s">'message_text'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Text</span>				   
				<span class="p">})</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>That’s the code for it and it comes out for the column names in the table as seen below</p>

<figure class="highlight">
  <pre><code class="language-sql" data-lang="sql"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
</pre></td><td class="code"><pre><span class="o">|</span> <span class="n">backend_name</span> <span class="o">|</span> <span class="n">project</span> <span class="o">|</span> <span class="n">mailing_list</span> <span class="o">|</span> <span class="n">category</span> <span class="o">|</span> <span class="n">subject</span> <span class="o">|</span> <span class="n">date</span> <span class="o">|</span> <span class="n">timezone_UTC</span> <span class="o">|</span> <span class="n">message_from</span>    <span class="o">|</span> <span class="n">message_id</span> <span class="o">|</span> <span class="k">message_text</span>  <span class="o">|</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>Now we’re going to refer back to this piece of code I showed you before and specifically lines 16-19.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="code"><pre><span class="kn">from</span> <span class="nn">dateutil.parser</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="k">def</span> <span class="nf">add_row_mess</span><span class="p">(</span><span class="n">columns1</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="n">di</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">archives</span><span class="p">):</span>
	<span class="n">temp</span> <span class="o">=</span> 	<span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'body'</span><span class="p">][</span><span class="s">'plain'</span><span class="p">]</span>
	<span class="n">words</span> <span class="o">=</span> <span class="s">""</span>
	<span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
	<span class="n">val</span> <span class="o">=</span> <span class="bp">False</span>
	<span class="c">#print(temp,"\n\n\nHEREEEEEEEEEEEEE!!!!!!!!!!!\n\n\n")</span>
	<span class="n">prev</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">):</span>
		<span class="n">j</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span><span class="mi">5000</span><span class="p">):</span>
			<span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
			<span class="c">#date[5] = date[5][0:1] + ':' +  date[5][1:3]</span>
			<span class="c">#print(date[5])</span>
			<span class="n">split</span> <span class="o">=</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Date'</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">s</span> <span class="o">=</span> <span class="s">" "</span>
			<span class="n">date</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">split</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
			<span class="n">zone</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
			<span class="n">li</span> <span class="o">=</span> <span class="p">[[</span><span class="n">di</span><span class="p">[</span><span class="s">'backend_name'</span><span class="p">],</span><span class="n">di</span><span class="p">[</span><span class="s">'origin'</span><span class="p">],</span><span class="n">archives</span><span class="p">,</span>
			<span class="n">di</span><span class="p">[</span><span class="s">'category'</span><span class="p">],</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Subject'</span><span class="p">],</span>
			<span class="n">date</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span><span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'From'</span><span class="p">],</span>
			<span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Message-ID'</span><span class="p">],</span>
			<span class="n">temp</span><span class="p">[</span><span class="n">prev</span><span class="p">:</span><span class="n">j</span><span class="p">]</span> <span class="p">]]</span>
			<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">li</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">columns1</span><span class="p">)</span>
			<span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
			<span class="n">df</span> <span class="o">=</span> <span class="n">df3</span>
			<span class="n">prev</span> <span class="o">=</span> <span class="n">j</span>
			<span class="n">row</span><span class="o">+=</span><span class="mi">1</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>Now my problem when using a function called parse (line 1)
is that in the json file the format looks like this</p>

<figure class="highlight">
  <pre><code class="language-javascript" data-lang="javascript"><span class="s2">"Date"</span><span class="p">:</span> <span class="s2">"Fri, 23 Oct 2015 14:07:16 +0000"</span><span class="p">,</span></code></pre>
</figure>

<p>but when I used the parse function it was formatting it as a datetime64 object in pandas and when trying to appened this to another dataframe it was not having it. After working on it for about three hours getting the same error continuously “date type not understood” I decided let’s see how it looks in the database as just a string and when uploading it, it actually cut off the timezone. So I was like you know what I’m just going to upload the timezone seperately and everything worked fine from there the datetime object was okay and the timezone had it’s own column. So yes before timezone was’t initially a column heading.</p>

<p>Goal 2:<br />
So for this goal I think I might need to clarify if what I have in the <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/PiperMail.ipynb">jupyter</a> notebook is fine or if I need to change some things.</p>

<p>Goal 3:<br />
I don’t think you all realize how pumped I am for this part of my work, because this will actually involve using things related to NLP(Natural Language Processing). I am really excited to start this, but we haven’t reached there as yet.</p>

<p>Goal 4:<br />
And for this part we haven’t dicussed it as much but what I’m seeing from the threads I’ve looked at in the mailing lists they seem to use ‘&gt;’ to indicate a thread but this is used for other things, so some more thought is going to have to be put into this.</p>

<h2 id="ongoing-tasks-1">Ongoing Tasks</h2>

<p>Well I could give just a general answer to these, it’s ongoing so you know pushing things to the <a href="https://github.com/OSSHealth/augur/tree/pipermail">Augur</a> git repository (I’m on the pipermail branch of the project). And well I’m hopefully finishing the pulling of mailing lists.</p>

<p>Links:
<a href="https://www.theodysseyonline.com/an-open-letter-from-slow-replier">Office gif</a></p>

<p>Files Used:
Python File - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/PiperReader%207.py">PiperRead 7</a><br />
Jupyter Notebook - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/PiperMail.ipynb">PiperMail</a></p>

  </div><a class="u-url" href="/misc/2018/06/15/gsoc-Week-5.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Keanu Nichols Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Keanu Nichols</li><li><a class="u-email" href="mailto:keanu.nichols@my.uwi.edu">keanu.nichols@my.uwi.edu</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/kmn5409"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">kmn5409</span></a></li><li><a href="https://www.linkedin.com/in/keanu-nichols"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">keanu-nichols</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>rss</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>My blog for writing about my school/work experience and projects that I have worked on.
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
