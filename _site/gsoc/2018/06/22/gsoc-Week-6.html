<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.4.0 -->
<title>GSoC Week 6: I need some space | Keanu Nichols Blog</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="GSoC Week 6: I need some space" />
<meta name="author" content="Keanu Nichols" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="So it’s my third post, maybe I’m actually going to keep this up, wouldn’t that just be great, hopefully. I passed my first evaluation by the way! That made my day to be honest, especially because some people actually failed it due to issues with their mentor it seemed, so I’m very thankful that didn’t happen to me. Now this blog post is about improving some stuff in both the PiperReader python file and the jupyter notebook. We’re going to look at how to save some space, considering I didn’t care about it before, but that could be an issue when you try to download for example 1GB worth of emails, yeah it’s happened before. ALSO we will touch a little on some NLP (Natural Language Processing), sadly it’s in the very early stages but I’m pretty excited for it, I hope it goes well." />
<meta property="og:description" content="So it’s my third post, maybe I’m actually going to keep this up, wouldn’t that just be great, hopefully. I passed my first evaluation by the way! That made my day to be honest, especially because some people actually failed it due to issues with their mentor it seemed, so I’m very thankful that didn’t happen to me. Now this blog post is about improving some stuff in both the PiperReader python file and the jupyter notebook. We’re going to look at how to save some space, considering I didn’t care about it before, but that could be an issue when you try to download for example 1GB worth of emails, yeah it’s happened before. ALSO we will touch a little on some NLP (Natural Language Processing), sadly it’s in the very early stages but I’m pretty excited for it, I hope it goes well." />
<link rel="canonical" href="http://localhost:4000/gsoc/2018/06/22/gsoc-Week-6.html" />
<meta property="og:url" content="http://localhost:4000/gsoc/2018/06/22/gsoc-Week-6.html" />
<meta property="og:site_name" content="Keanu Nichols Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-06-22T06:20:00-04:00" />
<script type="application/ld+json">
{"description":"So it’s my third post, maybe I’m actually going to keep this up, wouldn’t that just be great, hopefully. I passed my first evaluation by the way! That made my day to be honest, especially because some people actually failed it due to issues with their mentor it seemed, so I’m very thankful that didn’t happen to me. Now this blog post is about improving some stuff in both the PiperReader python file and the jupyter notebook. We’re going to look at how to save some space, considering I didn’t care about it before, but that could be an issue when you try to download for example 1GB worth of emails, yeah it’s happened before. ALSO we will touch a little on some NLP (Natural Language Processing), sadly it’s in the very early stages but I’m pretty excited for it, I hope it goes well.","author":{"@type":"Person","name":"Keanu Nichols"},"@type":"BlogPosting","url":"http://localhost:4000/gsoc/2018/06/22/gsoc-Week-6.html","headline":"GSoC Week 6: I need some space","dateModified":"2018-06-22T06:20:00-04:00","datePublished":"2018-06-22T06:20:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/gsoc/2018/06/22/gsoc-Week-6.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Keanu Nichols Blog" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Keanu Nichols Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/portfolio/">Porfolio</a><a class="page-link" href="/temp/">temp</a></div>
      </nav></div>
</header>
<!-- Begin Jekyll SEO tag v2.4.0 -->
<title>GSoC Week 6: I need some space | Keanu Nichols Blog</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="GSoC Week 6: I need some space" />
<meta name="author" content="Keanu Nichols" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="So it’s my third post, maybe I’m actually going to keep this up, wouldn’t that just be great, hopefully. I passed my first evaluation by the way! That made my day to be honest, especially because some people actually failed it due to issues with their mentor it seemed, so I’m very thankful that didn’t happen to me. Now this blog post is about improving some stuff in both the PiperReader python file and the jupyter notebook. We’re going to look at how to save some space, considering I didn’t care about it before, but that could be an issue when you try to download for example 1GB worth of emails, yeah it’s happened before. ALSO we will touch a little on some NLP (Natural Language Processing), sadly it’s in the very early stages but I’m pretty excited for it, I hope it goes well." />
<meta property="og:description" content="So it’s my third post, maybe I’m actually going to keep this up, wouldn’t that just be great, hopefully. I passed my first evaluation by the way! That made my day to be honest, especially because some people actually failed it due to issues with their mentor it seemed, so I’m very thankful that didn’t happen to me. Now this blog post is about improving some stuff in both the PiperReader python file and the jupyter notebook. We’re going to look at how to save some space, considering I didn’t care about it before, but that could be an issue when you try to download for example 1GB worth of emails, yeah it’s happened before. ALSO we will touch a little on some NLP (Natural Language Processing), sadly it’s in the very early stages but I’m pretty excited for it, I hope it goes well." />
<link rel="canonical" href="http://localhost:4000/gsoc/2018/06/22/gsoc-Week-6.html" />
<meta property="og:url" content="http://localhost:4000/gsoc/2018/06/22/gsoc-Week-6.html" />
<meta property="og:site_name" content="Keanu Nichols Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-06-22T06:20:00-04:00" />
<script type="application/ld+json">
{"description":"So it’s my third post, maybe I’m actually going to keep this up, wouldn’t that just be great, hopefully. I passed my first evaluation by the way! That made my day to be honest, especially because some people actually failed it due to issues with their mentor it seemed, so I’m very thankful that didn’t happen to me. Now this blog post is about improving some stuff in both the PiperReader python file and the jupyter notebook. We’re going to look at how to save some space, considering I didn’t care about it before, but that could be an issue when you try to download for example 1GB worth of emails, yeah it’s happened before. ALSO we will touch a little on some NLP (Natural Language Processing), sadly it’s in the very early stages but I’m pretty excited for it, I hope it goes well.","author":{"@type":"Person","name":"Keanu Nichols"},"@type":"BlogPosting","url":"http://localhost:4000/gsoc/2018/06/22/gsoc-Week-6.html","headline":"GSoC Week 6: I need some space","dateModified":"2018-06-22T06:20:00-04:00","datePublished":"2018-06-22T06:20:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/gsoc/2018/06/22/gsoc-Week-6.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">GSoC Week 6: I need some space</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-06-22T06:20:00-04:00" itemprop="datePublished">Jun 22, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><br /><br />
So it’s my third post, maybe I’m actually going to keep this up, wouldn’t that just be great, hopefully. I passed my first evaluation by the way! That made my day to be honest, especially because some people actually failed it due to issues with their mentor it seemed, so I’m very thankful that didn’t happen to me. Now this blog post is about improving some stuff in both the PiperReader python file and the jupyter notebook. We’re going to look at how to save some space, considering I didn’t care about it before, but that could be an issue when you try to download for example 1GB worth of emails, yeah it’s happened before. ALSO we will touch a little on some NLP (Natural Language Processing), sadly it’s in the very early stages but I’m pretty excited for it, I hope it goes well.</p>

<p>So this week’s task with my mentor <a href="http://www.seangoggins.net/">Sean Goggins</a> is as follows:</p>

<h1 id="goals-for-the-week">Goals for the week:</h1>
<ol>
  <li>Make table revisions to add columns for tracking message parts</li>
  <li>Add a mailing list retrieval parameter to the augur.config.json file … You can use the .git repository retrieval specification in examples to see how this could be formatted. You may need to ask derek or carter how to then have your program parse out mailing list retrieval</li>
  <li>Include logic to keep track of the timestamp of the LAST message retrieved on each “load” …. add a “last_run” column to mailing_list_jobs, and then download only the mboxes not already included, and, for the oldest one, you will likely need to look for messages &gt; the “last_run” column timestamp. All the UTC conversions need to occur before this comparison …</li>
  <li>Do a simple sentiment analysis on each message. Perhaps keep the “score” in an additional column in the table.</li>
  <li>(Stretch Goal) : Experiment with ways of filtering out old message strings from mailing lists and identifying mailing list discussion threads (some lists have them automatically, some don’t)</li>
</ol>

<h2 id="goals">Goals</h2>

<p>Goal 1:<br />
Now what is this about? Well since in my last blog post we were looking at how to separate out really long posts and after talking with Sean he suggested that for people querying the SQL table having a counter as to how many lines the message is split up into and also what part of the message we’re in. So I had to therefore add some columns to the table and you will see it below, the added columns are ‘augurmsgID’,’message_part’ and ‘message_parts_tot’.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="n">df5</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">db_name</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="p">,</span><span class="n">if_exists</span><span class="o">=</span><span class="s">'replace'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s">'augurmsgID'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span>
                <span class="s">'backend_name'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
                <span class="s">'project'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
                <span class="s">'mailing_list'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
                <span class="s">'category'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
                <span class="s">'message_part'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span>
                <span class="s">'message_parts_tot'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span>
                <span class="s">'subject'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">400</span><span class="p">),</span>
                <span class="s">'date'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">DateTime</span><span class="p">(),</span>
                <span class="s">'message_from'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
                <span class="s">'message_id'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
                <span class="s">'message_text'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">12000</span><span class="p">)</span>
            <span class="p">})</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>So ‘message_parts_tot’ is how many parts the message was split into as seen below (Line 14) is where I actually calculated it, the if statement is for when the ‘mess_row_tot’ went over
a multiple of 7000, since I was storing the message in dataframes of 7000 characters in length. For ‘message_part’ as seen below I used a variable called row_num (line 10) and set it to zero before the loop, and going through the iterations of the message I would increment it by 1 (line 18).</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="code"><pre><span class="k">def</span> <span class="nf">add_row_mess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">columns1</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="n">di</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">archives</span><span class="p">,</span><span class="n">augurmsgID</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span>  <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'body'</span><span class="p">][</span><span class="s">'plain'</span><span class="p">]</span>
    <span class="n">words</span> <span class="o">=</span> <span class="s">""</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">val</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">prev</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="c">#print(length)</span>
    <span class="n">mess_row_tot</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">row_num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span><span class="p">(</span><span class="n">length</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">):</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">length</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mess_row_tot</span><span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="o">/</span><span class="mi">7000</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="n">mess_row_tot</span><span class="o">*</span><span class="mi">7000</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">length</span> <span class="p">):</span>
            <span class="n">mess_row_tot</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">length</span><span class="p">,</span><span class="mi">7000</span><span class="p">):</span>
            <span class="n">row_num</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_date</span><span class="p">(</span><span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Date'</span><span class="p">])</span>
            <span class="n">li</span> <span class="o">=</span> <span class="p">[[</span><span class="n">augurmsgID</span><span class="p">,</span><span class="n">di</span><span class="p">[</span><span class="s">'backend_name'</span><span class="p">],</span><span class="n">di</span><span class="p">[</span><span class="s">'origin'</span><span class="p">],</span><span class="n">archives</span><span class="p">,</span>
            <span class="n">di</span><span class="p">[</span><span class="s">'category'</span><span class="p">],</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">mess_row_tot</span><span class="p">,</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Subject'</span><span class="p">],</span>
            <span class="n">date</span><span class="p">,</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'From'</span><span class="p">],</span>
            <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Message-ID'</span><span class="p">],</span>
            <span class="n">temp</span><span class="p">[</span><span class="n">prev</span><span class="p">:</span><span class="n">j</span><span class="p">]</span> <span class="p">]]</span>
            <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">li</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">columns1</span><span class="p">)</span>
            <span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df3</span>
            <span class="n">prev</span> <span class="o">=</span> <span class="n">j</span>
            <span class="n">row</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">augurmsgID</span><span class="o">+=</span><span class="mi">1</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>Also overall in the python file I tried to make it more readable, by putting everything in the class, I might have put the functions in a bit of a stranger way, I think when I go more into documentation I’ll search up what is the conventional way.</p>

<p>Goal 2:<br />
I haven’t started this as yet, I wanted to get more clarification about how to implement it, doesn’t mean I was anywhere near to starting it though because I spent a bit of time on the next goal.</p>

<p>Goal 3:<br />
Now for this we’re going to start with the jupyter notebook (PiperMail) since that’s how it occurred to me and then I went to the python file after. So for this we want that if the user is first downloading the messages and uploads it to the SQL Database and created their table, they have in the table with only the mailing lists names called ‘mailing_list_jobs’ as seen below to store the most recent message they have. After say a day after they want to run the program again to download the most recent messages it only downloads and uploads the most recent message. Before I would keep downloading the messages, so we essentially want to save space because if they don’t download messages for like a few months and decide to download them it could be quite a lot of messages to download.</p>

<p>So I first check to see if the SQL table ‘mail_lists’ which is where all the messages are downloaded. I think check if the table ‘mailing_list_jobs’ was created which is where I store the names of all the mailing lists and I take the names of the mailing lists; if it wasn’t created then I create the table.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="n">table_names</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="n">connect</span><span class="o">.</span><span class="n">db</span><span class="p">)</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">table_names</span><span class="p">)</span>
<span class="n">val</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">mail_lists</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">if</span><span class="p">(</span><span class="s">"mail_lists"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table_names</span><span class="p">):</span>
    <span class="n">mail_lists</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">if</span><span class="p">(</span><span class="s">"mailing_list_jobs"</span> <span class="ow">in</span> <span class="n">table_names</span><span class="p">):</span>
    <span class="n">lists_createdSQL</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s">"""SELECT project FROM mailing_list_jobs"""</span><span class="p">)</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">lists_createdSQL</span><span class="p">,</span> <span class="n">connect</span><span class="o">.</span><span class="n">db</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
    <span class="n">val</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">columns2</span> <span class="o">=</span> <span class="s">"backend_name"</span><span class="p">,</span><span class="s">"mailing_list_url"</span><span class="p">,</span><span class="s">"project"</span><span class="p">,</span><span class="s">"last_message_date"</span>
    <span class="n">df_mail_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns2</span><span class="p">)</span>
    <span class="n">df_mail_list</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'mailing_list_jobs'</span><span class="p">,</span><span class="n">con</span><span class="o">=</span><span class="n">connect</span><span class="o">.</span><span class="n">db</span><span class="p">,</span><span class="n">if_exists</span><span class="o">=</span><span class="s">'replace'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">lists_createdSQL</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s">"""SELECT project FROM mailing_list_jobs"""</span><span class="p">)</span>
    <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">lists_createdSQL</span><span class="p">,</span> <span class="n">connect</span><span class="o">.</span><span class="n">db</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Created Table"</span><span class="p">)</span></pre></td></tr></tbody></table></code></pre>
</figure>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['issue_response_time']
Created Table
</code></pre></div></div>

<p>The next part is where I’m going to download the mail archives. This is split into two parts, either the mailing list is not in the table in the SQL database so we have to download the archives and we use a dictionary ‘mail_check’ I made to say that it’s ‘new’ (Lines 20 - 33). Or the mailing list is already in the database so we pull from the table ‘mailing_list_jobs’ and take the last_message_date column for that mailing list and check to see if there have been anymore recent messages, from <a href="https://github.com/chaoss/grimoirelab-perceval">Perceval</a> there is a class called Pipermail that does this for us and if it has new messages we create the JSON file with the new messages and update that mailing list in the dictionary ‘mail_check’ to ‘update’ (Lines 34 - 54). Note that even if it has no recent messages at least the most recent mailing archive has to be downloaded because the class Pipermail has to check the messages in that archive.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre></td><td class="code"><pre><span class="c"># create an Augur application so we can test our function</span>
<span class="n">Piper</span> <span class="o">=</span> <span class="n">augurApp</span><span class="o">.</span><span class="n">piper</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">perceval</span><span class="o">.</span><span class="n">__path__</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">link</span> <span class="o">=</span> <span class="s">"https://lists.opendaylight.org/pipermail/"</span>
<span class="c">#mail = ["aalldp-dev","alto-dev","archetypes-dev"]</span>
<span class="c">#mail = ["aalldp-dev","alto-dev","archetypes-dev","dev"]</span>
<span class="c">#mail = ["aalldp-dev","archetypes-dev","alto-dev"]</span>
<span class="n">mail</span> <span class="o">=</span> <span class="p">[</span><span class="s">"aalldp-dev"</span><span class="p">,</span><span class="s">"archetypes-dev"</span><span class="p">]</span>
<span class="n">mail_check</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="bp">False</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mail</span><span class="p">}</span>
<span class="k">print</span><span class="p">(</span><span class="n">mail_check</span><span class="p">)</span>
<span class="c">#print(os.getcwd())</span>
<span class="nb">file</span> <span class="o">=</span> <span class="s">"opendaylight-"</span>
<span class="k">if</span> <span class="s">"notebooks"</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">():</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s">".."</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="s">"/augur/data/opendaylight-"</span> 
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mail</span><span class="p">)):</span>
    <span class="c">#print(link+mail[x])</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df1</span><span class="p">[</span><span class="s">'project'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="p">):</span>
        <span class="c">#print(os.getcwd())</span>
        <span class="c">#print(os.path.join(os.getcwd() + path+'.json'))</span>
        <span class="n">place</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span><span class="s">'.json'</span><span class="p">)</span>           
        <span class="n">repo</span> <span class="o">=</span> <span class="n">Pipermail</span><span class="p">(</span><span class="n">url</span> <span class="o">=</span> <span class="s">"https://lists.opendaylight.org/pipermail/"</span><span class="o">+</span> <span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="s">"/"</span><span class="p">,</span><span class="n">dirpath</span><span class="o">=</span><span class="s">"tmp/archives_"</span><span class="o">+</span><span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="c">#print(repo)</span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">place</span><span class="p">,</span><span class="s">"w+"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">repo</span><span class="o">.</span><span class="n">fetch</span><span class="p">():</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">mail_check</span><span class="p">[</span><span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">=</span> <span class="s">'new'</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Created File"</span><span class="p">,</span><span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">last_updatedSQL</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s">"""SELECT last_message_date FROM 
        mailing_list_jobs WHERE project = """</span> <span class="o">+</span>  <span class="s">"'"</span> <span class="o">+</span> <span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="s">"'"</span><span class="p">)</span>
        <span class="n">last_updated_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">last_updatedSQL</span><span class="p">,</span> <span class="n">connect</span><span class="o">.</span><span class="n">db</span><span class="p">)</span>
        <span class="n">time</span> <span class="o">=</span> <span class="p">(</span><span class="n">last_updated_df</span><span class="p">[</span><span class="s">'last_message_date'</span><span class="p">])</span>  
        <span class="n">time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
        <span class="n">place</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s">'temp_'</span> <span class="o">+</span> <span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span><span class="s">'.json'</span><span class="p">)</span>       
        <span class="n">repo</span> <span class="o">=</span> <span class="n">Pipermail</span><span class="p">(</span><span class="n">url</span> <span class="o">=</span> <span class="s">"https://lists.opendaylight.org/pipermail/"</span><span class="o">+</span> <span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="s">"/"</span><span class="p">,</span><span class="n">dirpath</span><span class="o">=</span><span class="s">"tmp/archives_"</span><span class="o">+</span><span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">place</span><span class="p">,</span><span class="s">"w+"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">repo</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">from_date</span><span class="o">=</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">mess_check</span> <span class="o">=</span> <span class="n">Piper</span><span class="o">.</span><span class="n">convert_date</span><span class="p">(</span><span class="n">message</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'Date'</span><span class="p">])</span>
            <span class="c">#mess_check = Piper.convert_date("Thu, 24 Mar 2019 20:37:11 +0000")</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mess_check</span> <span class="o">&gt;</span> <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
                <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Updated messages downloaded"</span><span class="p">)</span>
                <span class="n">mail_check</span><span class="p">[</span><span class="n">mail</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span> <span class="o">=</span> <span class="s">'update'</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Checking to see for updated messages"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">mail_check</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Finished downloading files"</span><span class="p">)</span></pre></td></tr></tbody></table></code></pre>
</figure>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2018-06-21 15:10:43 keanu-Inspiron-5567 perceval.backends.core.pipermail[21549] INFO Looking for messages from 'https://lists.opendaylight.org/pipermail/aalldp-dev/' since 1970-01-01 00:00:00+00:00
2018-06-21 15:10:43 keanu-Inspiron-5567 perceval.backends.core.pipermail[21549] INFO Downloading mboxes from 'https://lists.opendaylight.org/pipermail/aalldp-dev/' to since 1970-01-01 00:00:00+00:00


/home/keanu/temp/augur_push/augur4/augur/notebooks
_NamespacePath(['/home/keanu/anaconda3/envs/augur/lib/python3.6/site-packages/perceval'])
/home/keanu/temp/augur_push/augur4/augur/notebooks
{'aalldp-dev': False, 'archetypes-dev': False}


2018-06-21 15:10:45 keanu-Inspiron-5567 perceval.backends.core.pipermail[21549] INFO 1/1 MBoxes downloaded
2018-06-21 15:10:45 keanu-Inspiron-5567 perceval.backends.core.mbox[21549] INFO Done. 2/2 messages fetched; 0 ignored
2018-06-21 15:10:45 keanu-Inspiron-5567 perceval.backends.core.pipermail[21549] INFO Fetch process completed
2018-06-21 15:10:45 keanu-Inspiron-5567 perceval.backends.core.pipermail[21549] INFO Looking for messages from 'https://lists.opendaylight.org/pipermail/archetypes-dev/' since 1970-01-01 00:00:00+00:00
2018-06-21 15:10:45 keanu-Inspiron-5567 perceval.backends.core.pipermail[21549] INFO Downloading mboxes from 'https://lists.opendaylight.org/pipermail/archetypes-dev/' to since 1970-01-01 00:00:00+00:00


Created File aalldp-dev


2018-06-21 15:10:47 keanu-Inspiron-5567 perceval.backends.core.pipermail[21549] INFO 1/1 MBoxes downloaded
2018-06-21 15:10:47 keanu-Inspiron-5567 perceval.backends.core.mbox[21549] INFO Done. 2/2 messages fetched; 0 ignored
2018-06-21 15:10:47 keanu-Inspiron-5567 perceval.backends.core.pipermail[21549] INFO Fetch process completed


Created File archetypes-dev
{'aalldp-dev': 'new', 'archetypes-dev': 'new'}
Finished downloading files
</code></pre></div></div>

<p>Below also is the outline of the ‘mailing_list_jobs’ table in the SQL database.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><span class="n">df_mail_list</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"mailing_list_jobs"</span><span class="p">,</span><span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="p">,</span><span class="n">if_exists</span><span class="o">=</span><span class="s">'replace'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s">'backend_name'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
                            <span class="s">'mailing_list_url'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
                            <span class="s">'project'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
                            <span class="s">'last_message_date'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">DateTime</span><span class="p">()</span>
                    <span class="p">})</span></code></pre>
</figure>

<p>We now go back to the PiperReader python file. So I’m mostly going to focus on these few lines of code because the rest of the program mainly stays the same. This essentially uses the ‘mail_check’ dictionary I created before and if it’s key value is update then it reads the JSON file to pull the messages and upload it to the database. But if it’s new then it takes the JSON file that was created with all the messages and uploads all of it. However it it’s neither of these things and it’s set to the default value I set as False, then it just goes onto the next mailing list.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">archives</span><span class="p">)):</span>
    <span class="k">if</span><span class="p">(</span><span class="n">mail_check</span><span class="p">[</span><span class="n">archives</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">==</span> <span class="s">"update"</span><span class="p">):</span>
        <span class="n">place</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s">'opendaylight-'</span> <span class="o">+</span> <span class="s">'temp_'</span> <span class="o">+</span> <span class="n">archives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">elif</span><span class="p">(</span><span class="n">mail_check</span><span class="p">[</span><span class="n">archives</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">==</span> <span class="s">'new'</span> <span class="p">):</span>
        <span class="n">place</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s">'opendaylight-'</span> <span class="o">+</span> <span class="n">archives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">new</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Skipping"</span><span class="p">)</span>
        <span class="k">continue</span></code></pre>
</figure>

<p>I also made the function convert_date because I used it in the jupyter notebook and it just converts from a datetime object to a datetime64 object in UTC to be stored in pandas.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">convert_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">di</span><span class="p">):</span>
    <span class="n">split</span> <span class="o">=</span> <span class="n">di</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">sign</span> <span class="o">==</span> <span class="s">'-'</span><span class="p">:</span>
        <span class="n">sign</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">hours</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">*</span> <span class="n">sign</span>
    <span class="n">mins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span> <span class="o">*</span> <span class="n">sign</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s">" "</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">split</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span> <span class="o">=</span> <span class="n">hours</span><span class="p">)</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span> <span class="o">=</span> <span class="n">mins</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">date</span></code></pre>
</figure>

<p>Now lets look at the Sentiment_Piper jupyter notebook, with this we start looking at the sentiment around the email. With this however you can see their are some problems with what NLTK (Natural Language Tool Kit) is looking at because for example in some of the emails there are error messages that it analyses which it doesn’t need to. So just to talk about what I’m using essentially we use NLTK but we also use this tool called VADER which has already trained the NLP (Natural Language Processor) to score messages. So NLTK is breaking up the messages into smaller parts and analyzing it and giving you a score, one is the positive, negative, neutral and compound scores respectively. We are going to have to fine tune it a bit to ignore things such as errors for example and I’m going to have to look at deleting out some message threads.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">nltk</span><span class="p">,</span> <span class="n">re</span><span class="p">,</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">word_tokenize</span>
<span class="kn">import</span> <span class="nn">os</span><span class="p">,</span><span class="n">json</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">sent_tokenize</span> 
<span class="kn">import</span> <span class="nn">nltk.data</span>
<span class="kn">from</span> <span class="nn">nltk.sentiment.vader</span> <span class="kn">import</span> <span class="n">SentimentIntensityAnalyzer</span>
<span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">sentiment</span>
<span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">word_tokenize</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="c">#nltk.download('punkt')</span>
<span class="c">#nltk.download('stopwords')</span>
<span class="c">#pip install twython</span>
<span class="c">#nltk.download('vader_lexicon')</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read_json</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">y</span><span class="o">=</span><span class="s">""</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="s">"</span><span class="se">\"</span><span class="s">origin</span><span class="se">\"</span><span class="s">:"</span> <span class="ow">or</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">11</span><span class="p">]</span> <span class="o">==</span> <span class="s">"</span><span class="se">\"</span><span class="s">unixfrom</span><span class="se">\"</span><span class="s">:"</span><span class="p">):</span>
            <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">y</span><span class="o">+=</span><span class="n">line</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span><span class="p">(</span><span class="n">k</span><span class="o">==</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">line</span> <span class="o">==</span> <span class="s">"}"</span><span class="p">):</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">y</span><span class="p">,</span><span class="n">j</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">link</span> <span class="o">=</span> <span class="s">"https://lists.opendaylight.org/pipermail/"</span>
<span class="n">archives</span> <span class="o">=</span> <span class="p">[</span><span class="s">"aalldp-dev"</span><span class="p">,</span><span class="s">"archetypes-dev"</span><span class="p">]</span>
<span class="n">path</span> <span class="o">=</span> <span class="s">"/augur/data/"</span>

<span class="k">if</span> <span class="s">"notebooks"</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">():</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s">".."</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">archives</span><span class="p">)):</span>
    <span class="n">place</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="s">'opendaylight-'</span> <span class="o">+</span> <span class="n">archives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">path</span> <span class="o">+</span> <span class="n">archives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">place</span> <span class="o">+</span> <span class="s">'.json'</span><span class="p">,</span><span class="s">'r'</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="c">#print(x,"\n\n\n")</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">data</span><span class="p">,</span><span class="n">j</span> <span class="o">=</span> <span class="n">read_json</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">di</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c">#print(repr((di['data']['body']['plain'])))</span>
    <span class="k">while</span><span class="p">(</span><span class="n">j</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">di</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'body'</span><span class="p">][</span><span class="s">'plain'</span><span class="p">]</span>
        <span class="c">#print(raw)</span>
        <span class="c"># Next, we initialize VADER so we can use it within our Python script</span>
        <span class="n">sid</span> <span class="o">=</span> <span class="n">SentimentIntensityAnalyzer</span><span class="p">()</span>

        <span class="c"># We will also initialize our 'english.pickle' function and give it a short name</span>

        <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">'tokenizers/punkt/english.pickle'</span><span class="p">)</span>
        <span class="n">message_text</span> <span class="o">=</span> <span class="n">raw</span>
        <span class="n">sentences</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">message_text</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">:</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="n">sid</span><span class="o">.</span><span class="n">polarity_scores</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
            <span class="c">#print(scores)</span>
            <span class="k">print</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scores</span><span class="p">):</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">'{0}: {1}, '</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">scores</span><span class="p">[</span><span class="n">key</span><span class="p">]),</span> <span class="n">end</span><span class="o">=</span><span class="s">''</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
        <span class="c">#print("\n\n","-"*70,"\n\n")</span>
        <span class="n">data</span><span class="p">,</span><span class="n">r</span><span class="o">=</span> <span class="n">read_json</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">:])</span>
        <span class="n">j</span><span class="o">+=</span><span class="n">r</span>
        <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="k">break</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"*"</span><span class="o">*</span><span class="mi">40</span><span class="p">,</span><span class="s">"NEW MESSAGE"</span><span class="p">,</span><span class="s">"*"</span><span class="o">*</span><span class="mi">40</span><span class="p">,</span><span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">di</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n\n</span><span class="s">"</span><span class="p">)</span>
    
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hi Brian Kaczynski &lt;kaczynskib at avaya.com&gt;, Dennis Flynn &lt;drflynn at avaya.com&gt;,

Please reply to this email to indicate that you are still an active committer on this project.
compound: 0.6124, neg: 0.0, neu: 0.839, pos: 0.161, 


Best Regards,
An Ho
compound: 0.6369, neg: 0.0, neu: 0.417, pos: 0.583, 


**************************************** NEW MESSAGE **************************************** 


Hi AALLDP Team,



1.
compound: 0.0, neg: 0.0, neu: 1.0, pos: 0.0, 


Does your project have any plans to be archived?
compound: 0.0, neg: 0.0, neu: 1.0, pos: 0.0, 


If your project has no plans for any future active development, project committers can vote to move a project to the Archived State by a Termination Review according to the OpenDaylight Project Lifecycle and Releases document [1].
compound: 0.128, neg: 0.058, neu: 0.871, pos: 0.071, 


2.
compound: 0.0, neg: 0.0, neu: 1.0, pos: 0.0, 


If you projects plans to remain active, does it intend to participate in the Boron Simultaneous Release as documented in the Boron Release Plan [2]?
compound: 0.4019, neg: 0.0, neu: 0.899, pos: 0.101, 


If not, could someone please publicly decline to participate with a message like so: "The &lt;PROJECT_NAME&gt; project is formally declining to participate in the Boron SR".
compound: 0.1376, neg: 0.071, neu: 0.838, pos: 0.091, 


There are no project related activity on Gerrit.
compound: -0.296, neg: 0.239, neu: 0.761, pos: 0.0, 


Best Regards,

An Ho



[1] https://www.opendaylight.org/project-lifecycle-releases

[2] https://wiki.opendaylight.org/view/Simultaneous_Release:Boron_Release_Plan


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;http://lists.opendaylight.org/pipermail/aalldp-dev/attachments/20160324/6e137881/attachment.html&gt;
compound: 0.7506, neg: 0.0, neu: 0.726, pos: 0.274, 






This is just a test.
compound: 0.0, neg: 0.0, neu: 1.0, pos: 0.0, 


-- 
Andrew J Grimberg
Lead, IT Release Engineering
The Linux Foundation

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 488 bytes
Desc: OpenPGP digital signature
URL: &lt;http://lists.opendaylight.org/pipermail/archetypes-dev/attachments/20180417/126c0b23/attachment-0001.sig&gt;
compound: 0.296, neg: 0.0, neu: 0.932, pos: 0.068, 


**************************************** NEW MESSAGE **************************************** 


Hello archetypians,

Just to let you all know that
https://lists.opendaylight.org/pipermail/archetypes-dev/ works now (thanks
Andy!).
compound: 0.0, neg: 0.0, neu: 1.0, pos: 0.0, 


Just in case anyone in the future every looks back at the first message on
this list, here is the background to how this all started:

* https://wiki.opendaylight.org/view/Archetypes

* https://lists.opendaylight.org/pipermail/tsc/2018-April/009333.html

* https://jira.linuxfoundation.org/browse/RELENG-854 and its linked issues

Tx,
M.
--
Michael Vorburger, Red Hat
vorburger at redhat.com | IRC: vorburger @freenode | ~ = http://vorburger.ch
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;http://lists.opendaylight.org/pipermail/archetypes-dev/attachments/20180418/b55eba01/attachment.html&gt;
compound: 0.5719, neg: 0.0, neu: 0.923, pos: 0.077, 
</code></pre></div></div>

<p>Resources:
https://programminghistorian.org/en/lessons/sentiment-analysis</p>

<p>Files Used:
Python File - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/PiperReader%2012.py#L149">PiperRead 12</a><br />
Jupyter Notebook - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/PiperMail%204.ipynb">PiperMail 4</a></p>

<p>Jupyter Notebook - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/NLP/Sentiment_Piper%202.ipynb">Sentiment_Piper 2</a></p>


  </div><a class="u-url" href="/gsoc/2018/06/22/gsoc-Week-6.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Keanu Nichols Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Keanu Nichols</li><li><a class="u-email" href="mailto:keanu.nichols@my.uwi.edu">keanu.nichols@my.uwi.edu</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/kmn5409"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">kmn5409</span></a></li><li><a href="https://www.linkedin.com/in/keanu-nichols"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">keanu-nichols</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>rss</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A blog about Keanu Nichols for writing about his school/work experience and projects that he worked on.
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
