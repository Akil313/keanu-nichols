<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.4.0 -->
<title>GSoC Week 12: Stay up to date | Keanu Nichols</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="GSoC Week 12: Stay up to date" />
<meta name="author" content="Keanu Nichols" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We only have a little over one week now, lot’s of things were learnt and a bunch of mistakes were made but I think I’m learning which I think is awesome! This week we’re looking at only two goals but the first goal to be honest involved a lot of thinking but I believe I was able to solve the problem. I still need to do some more testing and have to implement it for another jupyter notebook (pull_requests), but i’ll get into that later on. The second goal I started it this week but I got caught up with the first task, because the second task involves me using a different technology I have to see if it actually helps me pull the emails from the lkml (Linux Kernel Mailing List)." />
<meta property="og:description" content="We only have a little over one week now, lot’s of things were learnt and a bunch of mistakes were made but I think I’m learning which I think is awesome! This week we’re looking at only two goals but the first goal to be honest involved a lot of thinking but I believe I was able to solve the problem. I still need to do some more testing and have to implement it for another jupyter notebook (pull_requests), but i’ll get into that later on. The second goal I started it this week but I got caught up with the first task, because the second task involves me using a different technology I have to see if it actually helps me pull the emails from the lkml (Linux Kernel Mailing List)." />
<link rel="canonical" href="http://localhost:4000/gsoc/2018/08/03/gsoc-Week-12.html" />
<meta property="og:url" content="http://localhost:4000/gsoc/2018/08/03/gsoc-Week-12.html" />
<meta property="og:site_name" content="Keanu Nichols" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-03T06:20:00-04:00" />
<script type="application/ld+json">
{"description":"We only have a little over one week now, lot’s of things were learnt and a bunch of mistakes were made but I think I’m learning which I think is awesome! This week we’re looking at only two goals but the first goal to be honest involved a lot of thinking but I believe I was able to solve the problem. I still need to do some more testing and have to implement it for another jupyter notebook (pull_requests), but i’ll get into that later on. The second goal I started it this week but I got caught up with the first task, because the second task involves me using a different technology I have to see if it actually helps me pull the emails from the lkml (Linux Kernel Mailing List).","author":{"@type":"Person","name":"Keanu Nichols"},"@type":"BlogPosting","url":"http://localhost:4000/gsoc/2018/08/03/gsoc-Week-12.html","headline":"GSoC Week 12: Stay up to date","dateModified":"2018-08-03T06:20:00-04:00","datePublished":"2018-08-03T06:20:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/gsoc/2018/08/03/gsoc-Week-12.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Keanu Nichols" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Keanu Nichols</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/portfolio/">Porfolio</a><a class="page-link" href="/temp/">temp</a></div>
      </nav></div>
</header>
<!-- Begin Jekyll SEO tag v2.4.0 -->
<title>GSoC Week 12: Stay up to date | Keanu Nichols</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="GSoC Week 12: Stay up to date" />
<meta name="author" content="Keanu Nichols" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We only have a little over one week now, lot’s of things were learnt and a bunch of mistakes were made but I think I’m learning which I think is awesome! This week we’re looking at only two goals but the first goal to be honest involved a lot of thinking but I believe I was able to solve the problem. I still need to do some more testing and have to implement it for another jupyter notebook (pull_requests), but i’ll get into that later on. The second goal I started it this week but I got caught up with the first task, because the second task involves me using a different technology I have to see if it actually helps me pull the emails from the lkml (Linux Kernel Mailing List)." />
<meta property="og:description" content="We only have a little over one week now, lot’s of things were learnt and a bunch of mistakes were made but I think I’m learning which I think is awesome! This week we’re looking at only two goals but the first goal to be honest involved a lot of thinking but I believe I was able to solve the problem. I still need to do some more testing and have to implement it for another jupyter notebook (pull_requests), but i’ll get into that later on. The second goal I started it this week but I got caught up with the first task, because the second task involves me using a different technology I have to see if it actually helps me pull the emails from the lkml (Linux Kernel Mailing List)." />
<link rel="canonical" href="http://localhost:4000/gsoc/2018/08/03/gsoc-Week-12.html" />
<meta property="og:url" content="http://localhost:4000/gsoc/2018/08/03/gsoc-Week-12.html" />
<meta property="og:site_name" content="Keanu Nichols" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-03T06:20:00-04:00" />
<script type="application/ld+json">
{"description":"We only have a little over one week now, lot’s of things were learnt and a bunch of mistakes were made but I think I’m learning which I think is awesome! This week we’re looking at only two goals but the first goal to be honest involved a lot of thinking but I believe I was able to solve the problem. I still need to do some more testing and have to implement it for another jupyter notebook (pull_requests), but i’ll get into that later on. The second goal I started it this week but I got caught up with the first task, because the second task involves me using a different technology I have to see if it actually helps me pull the emails from the lkml (Linux Kernel Mailing List).","author":{"@type":"Person","name":"Keanu Nichols"},"@type":"BlogPosting","url":"http://localhost:4000/gsoc/2018/08/03/gsoc-Week-12.html","headline":"GSoC Week 12: Stay up to date","dateModified":"2018-08-03T06:20:00-04:00","datePublished":"2018-08-03T06:20:00-04:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/gsoc/2018/08/03/gsoc-Week-12.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">GSoC Week 12: Stay up to date</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-08-03T06:20:00-04:00" itemprop="datePublished">Aug 3, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><br />
We only have a little over one week now, lot’s of things were learnt and a bunch of mistakes were made but I think I’m learning which I think is awesome! This week we’re looking at only two goals but the first goal to be honest involved a lot of thinking but I believe I was able to solve the problem. I still need to do some more testing and have to implement it for another jupyter notebook (pull_requests), but i’ll get into that later on. The second goal I started it this week but I got caught up with the first task, because the second task involves me using a different technology I have to see if it actually helps me pull the emails from the lkml (Linux Kernel Mailing List).</p>

<p>So this week’s task with my mentor <a href="http://www.seangoggins.net/">Sean Goggins</a> is as follows:</p>

<h1 id="goals-for-the-week">Goals for the week:</h1>
<ol>
  <li>Make the pipermail/github/perceval architecture to pull from the last time the pulls took place. So, if I pull at August 3, 2018 at 2:22pm UTC, I would then check that last successful run time and only pull from communication records after that time.</li>
  <li>Investigate non-Perceval mechanisms for getting HTML stored email lists.</li>
</ol>

<h1 id="extra">Extra:</h1>
<p>3) Upload all the pull-requests.</p>

<h2 id="goals">Goals</h2>

<p>Goal 1:<br />
We begin with this first goal, now as per usual I didn’t start thinking about the future so I just started off with the initial goal of just pulling the different github-issues and pull-requests and uploading it to the SQL Database. Now the problem with that is that when you’re just trying to update the database, you will have to download all the github-issues and pull-requests and reupload it to the Database.</p>

<h3 id="github-issues">Github-issues</h3>

<h4 id="comments">Comments:</h4>

<p>So we first go about checking to see if the the table “github_issues_2” was created (I named it this because I’m doing some testing) (line 10). This table stores all the comments in all the different issues in github repositories. If it’s in the database we count the number of lines it has because later on we will want to add more messages and we will need to set the column “augurmsgID” to the number of lines in the table and then increment that number by each new message. If the table isn’t in the Database we then have an indicator that tells us this (line 12).</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="n">table_names</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="n">db</span><span class="p">)</span><span class="o">.</span><span class="n">get_table_names</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">table_names</span><span class="p">)</span>
<span class="n">val</span> <span class="o">=</span> <span class="bp">False</span>
<span class="c">#mail_lists = True</span>
<span class="n">git_repos</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">numb</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">item</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">columns2</span> <span class="o">=</span> <span class="s">"augurlistID"</span><span class="p">,</span><span class="s">"backend_name"</span><span class="p">,</span><span class="s">"github_repo_url"</span><span class="p">,</span><span class="s">"project"</span><span class="p">,</span><span class="s">"last_run"</span>
<span class="n">df_mail_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns2</span><span class="p">)</span>
<span class="k">if</span><span class="p">(</span><span class="s">"github_issues_2"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table_names</span><span class="p">):</span>
   <span class="c">#mail_lists = False</span>
   <span class="n">git_repos</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">else</span><span class="p">:</span>
   <span class="n">SQL</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s">"""SELECT COUNT(*) FROM github_issues_2"""</span><span class="p">)</span>
   <span class="n">df7</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">SQL</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
   <span class="n">augurmsgID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">df7</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
   <span class="n">item</span> <span class="o">=</span> <span class="n">augurmsgID</span></pre></td></tr></tbody></table></code></pre>
</figure>

<h4 id="git-repositories">Git-repositories:</h4>
<p>Next we go about determining whether the git repositories we’re downloading the messages for has been uploaded to the Database. If it has we just determine how many repositories are in the Database and if so we add a new git repositories we will add a new row in the Database. The column “augurlistID” will have the total number of rows +1 and if even more rows are added it will keep increasing by 1.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="k">if</span><span class="p">(</span><span class="s">"github_issues_repo_jobs"</span> <span class="ow">in</span> <span class="n">table_names</span><span class="p">):</span>
   <span class="n">lists_createdSQL</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s">"""SELECT project FROM github_issues_repo_jobs"""</span><span class="p">)</span>
   <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">lists_createdSQL</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
   <span class="k">print</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
   <span class="n">val</span> <span class="o">=</span> <span class="bp">True</span>
   <span class="n">val</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"""SELECT augurlistID FROM
                                  github_issues_repo_jobs
                                  ORDER BY augurlistID DESC LIMIT 1"""</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
       <span class="n">numb</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="s">'augurlistID'</span><span class="p">]</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>Example of how the table looks:</p>

<p><img src="https://raw.githubusercontent.com/kmn5409/keanu-nichols/master/_includes/GSoC_Week12.png" alt="github_issues_2" /></p>

<p>However if we don’t have a table with all the git repositories we’re going to download then we will then go about creating that table and have the column “augurlistID” as the primary key in the table.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre>   
<span class="k">else</span><span class="p">:</span>
   <span class="n">df_mail_list</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"github_issues_repo_jobs"</span><span class="p">,</span><span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="p">,</span><span class="n">if_exists</span><span class="o">=</span><span class="s">'replace'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s">'augurlistID'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">Integer</span><span class="p">(),</span>
                              <span class="s">'backend_name'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
                              <span class="s">'github_repo_url'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
                              <span class="s">'project'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">VARCHAR</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
                              <span class="s">'last_run'</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">DateTime</span><span class="p">()</span>
                       <span class="p">})</span>
   <span class="n">lists_createdSQL</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s">"""SELECT project FROM github_issues_repo_jobs"""</span><span class="p">)</span>
   <span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">lists_createdSQL</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
   <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"ALTER TABLE github_issues_repo_jobs ADD PRIMARY KEY (augurlistID)"</span><span class="p">)</span>
   <span class="k">print</span><span class="p">(</span><span class="s">"Created Table"</span><span class="p">)</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>After the check to see if the table with the git repositories were created we pull that table and store it in a “res” which will allow us to change things in the table and then commit that change so that the table in the Database will also be changed.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="n">Base</span> <span class="o">=</span> <span class="n">declarative_base</span><span class="p">(</span><span class="n">db</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">table</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
   <span class="n">__tablename__</span> <span class="o">=</span> <span class="s">'github_issues_repo_jobs'</span>
   <span class="n">__table_args__</span><span class="o">=</span><span class="p">{</span><span class="s">'autoload'</span><span class="p">:</span><span class="bp">True</span><span class="p">}</span>
  
<span class="n">Session</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">db</span><span class="p">)</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">()</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="nb">all</span><span class="p">()</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>You may not have realized but this structure is very similar to my jupyter notebook <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/PiperMail%2011.ipynb">PiperMail</a> the only different is that what we’re retreving github-issues instead of email’s from pipermail.</p>

<h4 id="updating">Updating</h4>
<p>We first store the time at which we ran this jupyter notebook <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/github-issues%205.ipynb">github-issues_3</a>
After we start looking at actually determining if the table with the git repositories we will download for is stored in that table form example if we want to download issues from “kmn5409/GSoC” then we will see it’s not in the table and create a dataframe that stores all the git repositories we want to add to the table. This also works for if this is the first time we’re downloading issues for repositories it will just have a dataframe with all the repositories.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre><span class="n">today</span> <span class="o">=</span> <span class="n">strftime</span><span class="p">(</span><span class="s">"</span><span class="si">%</span><span class="s">a, </span><span class="si">%</span><span class="s">d </span><span class="si">%</span><span class="s">b </span><span class="si">%</span><span class="s">Y </span><span class="si">%</span><span class="s">H:</span><span class="si">%</span><span class="s">M:</span><span class="si">%</span><span class="s">S +0000"</span><span class="p">,</span> <span class="n">gmtime</span><span class="p">())</span>
<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">repo_url</span><span class="p">:</span>       
       <span class="n">repo</span> <span class="o">=</span> <span class="n">GitHub</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="n">own</span><span class="p">,</span><span class="n">repository</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">api_token</span><span class="o">=</span><span class="n">token</span><span class="p">)</span>
       <span class="n">inside</span> <span class="o">=</span> <span class="n">own</span> <span class="o">+</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">y</span>
       <span class="k">if</span><span class="p">(</span><span class="n">inside</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df1</span><span class="p">[</span><span class="s">'project'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
               <span class="n">new</span> <span class="o">=</span> <span class="bp">True</span>
               <span class="n">li</span> <span class="o">=</span> <span class="p">[[</span><span class="n">numb</span><span class="p">,</span><span class="s">"GitHub"</span><span class="p">,</span><span class="s">'https://github.com/'</span> <span class="o">+</span> <span class="n">inside</span><span class="p">,</span> <span class="n">inside</span><span class="p">,</span><span class="n">Piper</span><span class="o">.</span><span class="n">convert_date</span><span class="p">(</span><span class="n">today</span><span class="p">)]]</span>
               <span class="n">df8</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">li</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">columns2</span><span class="p">)</span>
               <span class="n">df4</span> <span class="o">=</span> <span class="n">df_mail_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df8</span><span class="p">)</span>
               <span class="n">df_mail_list</span> <span class="o">=</span> <span class="n">df4</span>
               <span class="n">numb</span><span class="o">+=</span><span class="mi">1</span>
               <span class="n">froms</span> <span class="o">=</span> <span class="bp">None</span>
               <span class="c">#continue</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>However if we’re just downloading new issues for different repositories or adding new messages for past repositories then we store the last time we ran this jupyter notebook and update the time to when we just ran the notebook <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/github-issues%205.ipynb">github-issues_3</a>. Also “froms” is used to determine the last time we ran the program, if it’s the first time we have it equal to “None” else it has the last time we ran the program which is in a datetime object format.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre>       <span class="k">else</span><span class="p">:</span>
           <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
           <span class="c">#print(today)</span>
           <span class="n">time</span> <span class="o">=</span> <span class="n">Piper</span><span class="o">.</span><span class="n">convert_date</span><span class="p">(</span><span class="n">today</span><span class="p">)</span>
           <span class="k">while</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">project</span><span class="o">!=</span><span class="n">inside</span><span class="p">):</span>
               <span class="c">#print(res[j].project)</span>
               <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
           <span class="n">now</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">last_run</span>
           <span class="k">print</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
           <span class="n">res</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">last_run</span> <span class="o">=</span> <span class="n">time</span>
           <span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
           <span class="n">froms</span> <span class="o">=</span> <span class="n">now</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p><br /><br />
<span style="color:green">
<strong>I’ve begun to cut some parts of my code to make it easier to understand what new things I’m adding, so don’t be too surprised when you open the jupyter notebook and it has a lot more code in there.</strong></span><br /><br /></p>

<p>We then download the issues or pull-request that are after “froms”, so in here we do the usual determining if it’s a pull-request or an issue. If it’s an issue we store when the issue was created and then convert that to a datetime object and if this time is after “froms”. If “froms” is “None” we append this user and his comment and issue information. Else we append the user if the issue was created after the last time we ran the program.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span class="k">for</span> <span class="n">issues</span> <span class="ow">in</span> <span class="n">repo</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">from_date</span> <span class="o">=</span> <span class="n">froms</span><span class="p">):</span>
<span class="k">if</span> <span class="s">'pull_request'</span> <span class="ow">in</span> <span class="n">issues</span><span class="p">[</span><span class="s">'data'</span><span class="p">]:</span>
               <span class="c">#print(issues['data']['number'])</span>
               <span class="k">continue</span>
           <span class="k">else</span><span class="p">:</span>
               <span class="n">created</span> <span class="o">=</span> <span class="n">issues</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'created_at'</span><span class="p">]</span>
               <span class="c">#print(type(froms))</span>
               <span class="n">issue_time</span> <span class="o">=</span> <span class="n">created</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">created</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">]</span>
               <span class="n">issue_time</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">issue_time</span><span class="p">,</span><span class="s">"</span><span class="si">%</span><span class="s">Y-</span><span class="si">%</span><span class="s">m-</span><span class="si">%</span><span class="s">d </span><span class="si">%</span><span class="s">H:</span><span class="si">%</span><span class="s">M:</span><span class="si">%</span><span class="s">S"</span><span class="p">)</span>
               <span class="k">if</span><span class="p">(</span><span class="n">froms</span> <span class="o">==</span> <span class="bp">None</span><span class="p">):</span>
                   <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_user</span><span class="p">)</span>
                   <span class="n">item</span><span class="o">+=</span><span class="mi">1</span>
               <span class="k">elif</span><span class="p">(</span><span class="n">issue_time</span> <span class="o">&gt;</span> <span class="n">froms</span><span class="p">):</span>
                   <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_user</span><span class="p">)</span>
                   <span class="n">item</span><span class="o">+=</span><span class="mi">1</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>Finally we go through the comments of the issues and we do the same thing we did above.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">issues</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'comments_data'</span><span class="p">])):</span>
                   <span class="n">created</span> <span class="o">=</span> <span class="n">issues</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="s">'comments_data'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>\
                   <span class="p">[</span><span class="s">'created_at'</span><span class="p">]</span>
                   <span class="n">issue_time</span> <span class="o">=</span> <span class="n">created</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">created</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">19</span><span class="p">]</span>
                   <span class="n">issue_time</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">issue_time</span><span class="p">,</span><span class="s">"</span><span class="si">%</span><span class="s">Y-</span><span class="si">%</span><span class="s">m-</span><span class="si">%</span><span class="s">d </span><span class="si">%</span><span class="s">H:</span><span class="si">%</span><span class="s">M:</span><span class="si">%</span><span class="s">S"</span><span class="p">)</span>
                   <span class="k">if</span><span class="p">(</span><span class="n">froms</span> <span class="o">==</span> <span class="bp">None</span><span class="p">):</span>
                       <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_user</span><span class="p">)</span>
                       <span class="n">item</span><span class="o">+=</span><span class="mi">1</span>
                   <span class="k">elif</span><span class="p">(</span><span class="n">issue_time</span> <span class="o">&gt;</span> <span class="n">froms</span><span class="p">):</span>
                       <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_user</span><span class="p">)</span>
                       <span class="n">item</span><span class="o">+=</span><span class="mi">1</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>One problem I have to fix is that I get kicked off from download the pull requests because my rate is exceeded when downloading from github but this was solved in <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/github_pull_requests%201.ipynb">github_pull_requests</a>. I will just have to paste that code but the problem as usual means I have to wait hours for it to finish run because I have to wait for the github api key to reset.</p>

<p>Goal 2:<br />
As from last week I need sometime to look at alternative ways of downloading the lkml (Linux Kernel Mailing List). I have a piece of software that has some potential but I still need some more time to focus and try using it. In general however it seems most software that pull mailing list expects it to be in MBox format and not Mailman format (HTML emails).</p>

<p>Goal 3:<br />
This is a solution to <a href="https://kmn5409.github.io/keanu-nichols/gsoc/2018/07/27/gsoc-Week-11.html#here">last week’s</a> problem whereby the Github rate limit would be exceeded so the program would stop. This goes about uploading 500 lines in the Database and if the limit is exceeded the program sleeps. The problem is that it sleeps for around 1 hour.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">repo_url</span><span class="p">:</span>       
       <span class="n">repo</span> <span class="o">=</span> <span class="n">GitHub</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="n">own</span><span class="p">,</span><span class="n">repository</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">api_token</span><span class="o">=</span><span class="n">token</span><span class="p">,</span>\
                     <span class="n">sleep_for_rate</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">min_rate_to_sleep</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
       <span class="k">for</span> <span class="n">issues</span> <span class="ow">in</span> <span class="n">repo</span><span class="o">.</span><span class="n">fetch</span><span class="p">():</span>

       <span class="k">if</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">):</span>
               <span class="n">db</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">DB_STR</span><span class="p">)</span>
               <span class="n">df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'github_pull_requests'</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="p">,</span>\
                         <span class="n">if_exists</span><span class="o">=</span><span class="s">'append'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
               <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns1</span><span class="p">)</span>
               <span class="k">print</span><span class="p">(</span><span class="s">"Broken"</span><span class="p">)</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>I also encountered another problem whereby the program would be disconnected from the Database so I would have to reconnect.</p>

<figure class="highlight">
  <pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="k">if</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">):</span>
               <span class="n">db</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">DB_STR</span><span class="p">)</span>
               <span class="n">df</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'github_pull_requests'</span><span class="p">,</span> <span class="n">con</span><span class="o">=</span><span class="n">db</span><span class="p">,</span>\
                         <span class="n">if_exists</span><span class="o">=</span><span class="s">'append'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
               <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns1</span><span class="p">)</span>
               <span class="k">print</span><span class="p">(</span><span class="s">"Broken"</span><span class="p">)</span></pre></td></tr></tbody></table></code></pre>
</figure>

<p>Resources:
GSoC ideas (Specifically Ideas 2 &amp; 3): <a href="https://wiki.linuxfoundation.org/chaoss/gsoc-ideas">Ideas</a><br />
My proposal: <a href="https://github.com/kmn5409/chaoss-microtasks/blob/master/GSoC-2018-Keanu-Nichols-CHAOSS-proposal.pdf">My proposal</a></p>

<p>Files Used:
Python File - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/PiperReader%2016.py">PiperReader 16</a><br />
Jupyter Notebook - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/PiperMail%2012.ipynb">PiperMail 12</a></p>

<p>Jupyter Notebook - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/NLP/Sentiment_Piper%208.ipynb">Sentiment_Piper 8</a></p>

<p>Jupyter Notebook - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/github-issues%206.ipynb">github-issues 6</a></p>

<p>Jupyter Notebook - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/github_issues_scores%207.ipynb">github_issues_scores 7</a></p>

<p>Jupyter Notebook - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/github_pull_requests%201.ipynb">github_pull_requests 1</a></p>

<p>Jupyter Notebook - <a href="https://github.com/kmn5409/GSoC_CHAOSS/blob/master/Augur/Perceval/github_pull_requests_scores%201.ipynb">github_pull_requests_scores 1</a></p>


  </div><a class="u-url" href="/gsoc/2018/08/03/gsoc-Week-12.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Keanu Nichols</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Keanu Nichols</li><li><a class="u-email" href="mailto:keanu.nichols@my.uwi.edu">keanu.nichols@my.uwi.edu</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/kmn5409"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">kmn5409</span></a></li><li><a href="https://www.linkedin.com/in/keanu-nichols"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">keanu-nichols</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>rss</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A blog about Keanu Nichols for writing about his school/work experience and projects that he worked on.
</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
